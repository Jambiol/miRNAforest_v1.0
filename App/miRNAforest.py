from Rfunctions import targetSeq, oneHot
import numpy as np

miRNA = 'UGAGGUAGUAGGUUGUAUAGUU'
UTR = 'TGATAAGCAGTCATCCTCAGATCATTATCAGCCTGTGCCACGATTGCAGGAGTCCCTGCCATCATGTTTACAGAGGACAGTATTTGTGGGGAGGGATTTGGGGCTCAGAGTGGGGTAGGTTGGGAGAATGTCAGTATGTGGAAGTGTGGGTCTGTGTGTGTGTATGTGGGGGTCTGTGTGTTTATGTGTGTGTGTTGTGTGTGGGAGTGTGTAATTTAAAATTGTGATGTGTCCTGATAAGCTGAGCTCCTTAGCCTTTGTCCCAGAATGCCTCCTGCAGGGATTCTTCCTGCTTAGCTTGAGGGTGACTATGGAGCTGAGCAGGTGTTCTTCATTACCTCAGTGAGAAGCCAGCTTTCCTCATCAGGCCATTGTCCCTGAAGAGAAGGGCAGGGCTGAGGCCTCTCATTCCAGAGGAAGGGACACCAAGCCTTGGCTCTACCCTGAGTTCATAAATTTATGGTTCTCAGGCCTGACTCTCAGCAGCTATGGTAGGAACTGCTGGGCTTGGCAGCCCGGGTCATCTGTACCTCTGCCTCCTTTCCCCTCCCTCAGGCCGAAGGAGGAGTCAGGGAGAGCTGAACTATTAGAGCTGCCTGTGCCTTTTGCCATCCCCTCAACCCAGCTATGGTTCTCTCGCAAGGGAAGTCCTTGCAAGCTAATTCTTTGACCTGTTGGGAGTGAGGATGTCTGGGCCACTCAGGGGTCATTCATGGCCTGGGGGATGTACCAGCATCTCCCAGTTCATAATCACAACCCTTCAGATTTGCCTTATTGGCAGCTCTACTCTGGAGGTTTGTTTAGAAGAAGTGTGTCACCCTTAGGCCAGCACCATCTCTTTACCTCCTAATTCCACACCCTCACTGCTGTAGACATTTGCTATGAGCTGGGGATGTCTCTCATGACCAAATGCTTTTCCTCAAAGGGAGAGAGTGCTATTGTAGAGCCAGAGGTCTGGCCCTATGCTTCCGGCCTCCTGTCCCTCATCCATAGCACCTCCACATACCTGGCCCTGTGCCTTGGTGTGCTGTATCCATCCATGGGGCTGATTGTATTTACCTTCTACCTCTTGGCTGCCTTGTGAAGGAATTATTCCCATGAGTTGGCTGGGAATAAGTGCCAGGATGGAATGATGGGTCAGTTGTATCAGCACGTGTGGCCTGTTCTTCTATGGGTTGGACAACCTCATTTTAACTCAGTCTTTAATCTGAGAGGCCACAGTGCAATTTTATTTTATTTTTCTCATGATGAGGTTTTCTTAACTTAAAAGAACATGTATATAAACATGCTTGCATTATATTTGTAAATTTATGTGATGGCAAAGAAGGAGAGCATAGGAAACCACACAGACTTGGGCAGGGTACAGACACTCCCACTTGGCATCATTCACAGCAAGTCACTGGCCAGTGGCTGGATCTGTGAGGGGCTCTCTCATGATAGAAGGCTATGGGGATAGATGTGTGGACACATTGGACCTTTCCTGAGGAAGAGGGACTGTTCTTTTGTCCCAGAAAAGCAGTGGCTCCATTGGTGTTGACATACATCCAACATTAAAAGCCACCCCCAAATGCCCAAGAAAAAAAGAAAGACTTATCAACATTTGTTCCATGAG'

mRNASeq = targetSeq(miRNA, UTR)

if(np.isnan(mRNASeq[5])):
    print 'Canonical seed not found'

else:
    oneHotSeq = oneHot(miRNA, mRNASeq)
    target_oneHot = np.array(oneHotSeq)

    import pickle
    filename = 'models/RF_model.sav'
    RF = pickle.load(open(filename, 'rb'))
    result = RF.predict(target_oneHot)

    if result == 0.:
        print "Your 3'UTR is NOT a Target of your miRNA"

    elif result == 1.:
        print "Your 3'UTR is a Target of your miRNA"